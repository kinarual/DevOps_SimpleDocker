# Simple Docker

## Содержание

1.  [Готовый докер](#part-1-готовый-докер)
2.  [Операции с контейнером](#part-2-операции-с-контейнером)
3.  [Мини веб-сервер](#part-3-мини-веб-сервер)
4.  [Свой докер](#part-4-свой-докер)
5.  [Dockle](#part-5-dockle)
6.  [Базовый Docker Compose](#part-6-базовый-docker-compose)

## Part 1. Готовый докер

**== Задание ==**

##### Установить и запустить докер-образ с портами 80 и 443.

## Part 2. Операции с контейнером

**== Задание ==**

##### Создай на локальной машине файл _nginx.conf_ и настрой в нем по пути _/status_ отдачу страницы статуса сервера **nginx**.

##### Скопируй созданный конфигурационный файл _nginx.conf_ внутрь докер-образа.

##### Проверь, что по адресу _localhost:80/status_ отдается страничка со статусом сервера **nginx**.

##### Экспортируй контейнер в файл _container.tar_ через команду _export_.

##### Останови контейнер.

##### Удали образ, не удаляя перед этим контейнеры.

##### Удали остановленный контейнер.

##### Импортируй контейнер обратно через команду _import_.

##### Запусти импортированный контейнер.

##### Проверь, что по адресу _localhost:80/status_ отдается страничка со статусом сервера **nginx**.

## Part 3. Мини веб-сервер

**== Задание ==**

##### Напиши мини-сервер на **C** и **FastCgi**, который будет возвращать простейшую страничку с надписью `Hello World!`.

##### Запусти написанный мини-сервер через _spawn-fcgi_ на порту 8080.

##### Напиши свой _nginx.conf_, который будет проксировать все запросы с 81 порта на _127.0.0.1:8080_.

##### Проверь, что в браузере по _localhost:81_ отдается написанная тобой страничка.

##### Положи файл _nginx.conf_ по пути _./nginx/nginx.conf_ (это понадобится позже).

## Part 4. Свой докер

**== Задание ==**

#### Напиши свой докер-образ, который:

##### 1) собирает исходники мини сервера на FastCgi из [Части 3](#part-3-мини-веб-сервер);

##### 2) запускает его на 8080 порту;

##### 3) копирует внутрь образа написанный _./nginx/nginx.conf_;

##### 4) запускает **nginx**.

##### Собери написанный докер-образ через `docker build` при этом указав имя и тег.

##### Проверь через `docker images`, что все собралось корректно.

##### Запусти собранный докер-образ с маппингом 81 порта на 80 на локальной машине и маппингом папки _./nginx_ внутрь контейнера по адресу, где лежат конфигурационные файлы **nginx**'а (см. [Часть 2](#part-2-операции-с-контейнером)).

##### Проверь, что по localhost:80 доступна страничка написанного мини сервера.

##### Допиши в _./nginx/nginx.conf_ проксирование странички _/status_, по которой надо отдавать статус сервера **nginx**.

##### Перезапусти докер-образ.

##### Проверь, что теперь по _localhost:80/status_ отдается страничка со статусом **nginx**

## Part 5. **Dockle**

**== Задание ==**

##### Просканируй образ из предыдущего задания через `dockle [image_id|repository]`.

##### Исправь образ так, чтобы при проверке через **dockle** не было ошибок и предупреждений.

## Part 6. Базовый **Docker Compose**

**== Задание ==**

##### Напиши файл _docker-compose.yml_, с помощью которого:

##### 1) Подними докер-контейнер из [Части 5](#part-5-инструмент-dockle) _(он должен работать в локальной сети, т.е. не нужно использовать инструкцию **EXPOSE** и мапить порты на локальную машину)_.

##### 2) Подними докер-контейнер с **nginx**, который будет проксировать все запросы с 8080 порта на 81 порт первого контейнера.

##### Замапь 8080 порт второго контейнера на 80 порт локальной машины.

##### Останови все запущенные контейнеры.

##### Собери и запусти проект с помощью команд `docker-compose build` и `docker-compose up`.

##### Проверь, что в браузере по _localhost:80_ отдается написанная тобой страничка, как и ранее.
